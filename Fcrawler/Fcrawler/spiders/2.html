<!DOCTYPE html>
<!--[if IE 6]><html class="ie lt-ie8"><![endif]-->
<!--[if IE 7]><html class="ie lt-ie8"><![endif]-->
<!--[if IE 8]><html class="ie ie8"><![endif]-->
<!--[if IE 9]><html class="ie ie9"><![endif]-->
<!--[if !IE]><!--> <html> <!--<![endif]-->

  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=Edge">
<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"1255494d3a","applicationID":"1070872","transactionName":"e1daR0JWVV9RER9ZWkxdRxxDUVZE","queueTime":1,"applicationTime":55,"agent":"js-agent.newrelic.com/nr-632.min.js"}</script>
<script type="text/javascript">(window.NREUM||(NREUM={})).loader_config={xpid:"XAUOVFNACQMHVFlVBQ=="};window.NREUM||(NREUM={}),__nr_require=function(t,e,n){function r(n){if(!e[n]){var o=e[n]={exports:{}};t[n][0].call(o.exports,function(e){var o=t[n][1][e];return r(o?o:e)},o,o.exports)}return e[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({QJf3ax:[function(t,e){function n(t){function e(e,n,a){t&&t(e,n,a),a||(a={});for(var c=s(e),u=c.length,f=i(a,o,r),d=0;u>d;d++)c[d].apply(f,n);return f}function a(t,e){u[t]=s(t).concat(e)}function s(t){return u[t]||[]}function c(){return n(e)}var u={};return{on:a,emit:e,create:c,listeners:s,_events:u}}function r(){return{}}var o="nr@context",i=t("gos");e.exports=n()},{gos:"7eSDFh"}],ee:[function(t,e){e.exports=t("QJf3ax")},{}],3:[function(t){function e(t){try{i.console&&console.log(t)}catch(e){}}var n,r=t("ee"),o=t(1),i={};try{n=localStorage.getItem("__nr_flags").split(","),console&&"function"==typeof console.log&&(i.console=!0,-1!==n.indexOf("dev")&&(i.dev=!0),-1!==n.indexOf("nr_dev")&&(i.nrDev=!0))}catch(a){}i.nrDev&&r.on("internal-error",function(t){e(t.stack)}),i.dev&&r.on("fn-err",function(t,n,r){e(r.stack)}),i.dev&&(e("NR AGENT IN DEVELOPMENT MODE"),e("flags: "+o(i,function(t){return t}).join(", ")))},{1:20,ee:"QJf3ax"}],4:[function(t){function e(t,e,n,i,s){try{c?c-=1:r("err",[s||new UncaughtException(t,e,n)])}catch(u){try{r("ierr",[u,(new Date).getTime(),!0])}catch(f){}}return"function"==typeof a?a.apply(this,o(arguments)):!1}function UncaughtException(t,e,n){this.message=t||"Uncaught error with no additional information",this.sourceURL=e,this.line=n}function n(t){r("err",[t,(new Date).getTime()])}var r=t("handle"),o=t(6),i=t("ee"),a=window.onerror,s=!1,c=0;t("loader").features.err=!0,t(3),window.onerror=e;try{throw new Error}catch(u){"stack"in u&&(t(4),t(5),"addEventListener"in window&&t(1),window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent)&&t(2),s=!0)}i.on("fn-start",function(){s&&(c+=1)}),i.on("fn-err",function(t,e,r){s&&(this.thrown=!0,n(r))}),i.on("fn-end",function(){s&&!this.thrown&&c>0&&(c-=1)}),i.on("internal-error",function(t){r("ierr",[t,(new Date).getTime(),!0])})},{1:5,2:8,3:3,4:7,5:6,6:21,ee:"QJf3ax",handle:"D5DuLP",loader:"G9z0Bl"}],5:[function(t,e){function n(t){i.inPlace(t,["addEventListener","removeEventListener"],"-",r)}function r(t){return t[1]}var o=(t(1),t("ee").create()),i=t(2)(o),a=t("gos");if(e.exports=o,n(window),"getPrototypeOf"in Object){for(var s=document;s&&!s.hasOwnProperty("addEventListener");)s=Object.getPrototypeOf(s);s&&n(s);for(var c=XMLHttpRequest.prototype;c&&!c.hasOwnProperty("addEventListener");)c=Object.getPrototypeOf(c);c&&n(c)}else XMLHttpRequest.prototype.hasOwnProperty("addEventListener")&&n(XMLHttpRequest.prototype);o.on("addEventListener-start",function(t){if(t[1]){var e=t[1];"function"==typeof e?this.wrapped=t[1]=a(e,"nr@wrapped",function(){return i(e,"fn-",null,e.name||"anonymous")}):"function"==typeof e.handleEvent&&i.inPlace(e,["handleEvent"],"fn-")}}),o.on("removeEventListener-start",function(t){var e=this.wrapped;e&&(t[1]=e)})},{1:21,2:22,ee:"QJf3ax",gos:"7eSDFh"}],6:[function(t,e){var n=(t(2),t("ee").create()),r=t(1)(n);e.exports=n,r.inPlace(window,["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","msRequestAnimationFrame"],"raf-"),n.on("raf-start",function(t){t[0]=r(t[0],"fn-")})},{1:22,2:21,ee:"QJf3ax"}],7:[function(t,e){function n(t,e,n){t[0]=o(t[0],"fn-",null,n)}var r=(t(2),t("ee").create()),o=t(1)(r);e.exports=r,o.inPlace(window,["setTimeout","setInterval","setImmediate"],"setTimer-"),r.on("setTimer-start",n)},{1:22,2:21,ee:"QJf3ax"}],8:[function(t,e){function n(){u.inPlace(this,p,"fn-")}function r(t,e){u.inPlace(e,["onreadystatechange"],"fn-")}function o(t,e){return e}function i(t,e){for(var n in t)e[n]=t[n];return e}var a=t("ee").create(),s=t(1),c=t(2),u=c(a),f=c(s),d=window.XMLHttpRequest,p=["onload","onerror","onabort","onloadstart","onloadend","onprogress","ontimeout"];e.exports=a,window.XMLHttpRequest=function(t){var e=new d(t);try{a.emit("new-xhr",[],e),f.inPlace(e,["addEventListener","removeEventListener"],"-",o),e.addEventListener("readystatechange",n,!1)}catch(r){try{a.emit("internal-error",[r])}catch(i){}}return e},i(d,XMLHttpRequest),XMLHttpRequest.prototype=d.prototype,u.inPlace(XMLHttpRequest.prototype,["open","send"],"-xhr-",o),a.on("send-xhr-start",r),a.on("open-xhr-start",r)},{1:5,2:22,ee:"QJf3ax"}],9:[function(t){function e(t){var e=this.params,r=this.metrics;if(!this.ended){this.ended=!0;for(var i=0;c>i;i++)t.removeEventListener(s[i],this.listener,!1);if(!e.aborted){if(r.duration=(new Date).getTime()-this.startTime,4===t.readyState){e.status=t.status;var a=t.responseType,u="arraybuffer"===a||"blob"===a||"json"===a?t.response:t.responseText,f=n(u);if(f&&(r.rxSize=f),this.sameOrigin){var d=t.getResponseHeader("X-NewRelic-App-Data");d&&(e.cat=d.split(", ").pop())}}else e.status=0;r.cbTime=this.cbTime,o("xhr",[e,r,this.startTime])}}}function n(t){if("string"==typeof t&&t.length)return t.length;if("object"!=typeof t)return void 0;if("undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer&&t.byteLength)return t.byteLength;if("undefined"!=typeof Blob&&t instanceof Blob&&t.size)return t.size;if("undefined"!=typeof FormData&&t instanceof FormData)return void 0;try{return JSON.stringify(t).length}catch(e){return void 0}}function r(t,e){var n=i(e),r=t.params;r.host=n.hostname+":"+n.port,r.pathname=n.pathname,t.sameOrigin=n.sameOrigin}if(window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent)){t("loader").features.xhr=!0;var o=t("handle"),i=t(2),a=t("ee"),s=["load","error","abort","timeout"],c=s.length,u=t(1);t(4),t(3),a.on("new-xhr",function(){this.totalCbs=0,this.called=0,this.cbTime=0,this.end=e,this.ended=!1,this.xhrGuids={}}),a.on("open-xhr-start",function(t){this.params={method:t[0]},r(this,t[1]),this.metrics={}}),a.on("open-xhr-end",function(t,e){"loader_config"in NREUM&&"xpid"in NREUM.loader_config&&this.sameOrigin&&e.setRequestHeader("X-NewRelic-ID",NREUM.loader_config.xpid)}),a.on("send-xhr-start",function(t,e){var r=this.metrics,o=t[0],i=this;if(r&&o){var u=n(o);u&&(r.txSize=u)}this.startTime=(new Date).getTime(),this.listener=function(t){try{"abort"===t.type&&(i.params.aborted=!0),("load"!==t.type||i.called===i.totalCbs&&(i.onloadCalled||"function"!=typeof e.onload))&&i.end(e)}catch(n){try{a.emit("internal-error",[n])}catch(r){}}};for(var f=0;c>f;f++)e.addEventListener(s[f],this.listener,!1)}),a.on("xhr-cb-time",function(t,e,n){this.cbTime+=t,e?this.onloadCalled=!0:this.called+=1,this.called!==this.totalCbs||!this.onloadCalled&&"function"==typeof n.onload||this.end(n)}),a.on("xhr-load-added",function(t,e){var n=""+u(t)+!!e;this.xhrGuids&&!this.xhrGuids[n]&&(this.xhrGuids[n]=!0,this.totalCbs+=1)}),a.on("xhr-load-removed",function(t,e){var n=""+u(t)+!!e;this.xhrGuids&&this.xhrGuids[n]&&(delete this.xhrGuids[n],this.totalCbs-=1)}),a.on("addEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-added",[t[1],t[2]],e)}),a.on("removeEventListener-end",function(t,e){e instanceof XMLHttpRequest&&"load"===t[0]&&a.emit("xhr-load-removed",[t[1],t[2]],e)}),a.on("fn-start",function(t,e,n){e instanceof XMLHttpRequest&&("onload"===n&&(this.onload=!0),("load"===(t[0]&&t[0].type)||this.onload)&&(this.xhrCbStart=(new Date).getTime()))}),a.on("fn-end",function(t,e){this.xhrCbStart&&a.emit("xhr-cb-time",[(new Date).getTime()-this.xhrCbStart,this.onload,e],e)})}},{1:"XL7HBI",2:10,3:8,4:5,ee:"QJf3ax",handle:"D5DuLP",loader:"G9z0Bl"}],10:[function(t,e){e.exports=function(t){var e=document.createElement("a"),n=window.location,r={};e.href=t,r.port=e.port;var o=e.href.split("://");return!r.port&&o[1]&&(r.port=o[1].split("/")[0].split("@").pop().split(":")[1]),r.port&&"0"!==r.port||(r.port="https"===o[0]?"443":"80"),r.hostname=e.hostname||n.hostname,r.pathname=e.pathname,r.protocol=o[0],"/"!==r.pathname.charAt(0)&&(r.pathname="/"+r.pathname),r.sameOrigin=!e.hostname||e.hostname===document.domain&&e.port===n.port&&e.protocol===n.protocol,r}},{}],11:[function(t,e){function n(t){return function(){r(t,[(new Date).getTime()].concat(i(arguments)))}}var r=t("handle"),o=t(1),i=t(2);"undefined"==typeof window.newrelic&&(newrelic=window.NREUM);var a=["setPageViewName","addPageAction","setCustomAttribute","finished","addToTrace","inlineHit","noticeError"];o(a,function(t,e){window.NREUM[e]=n("api-"+e)}),e.exports=window.NREUM},{1:20,2:21,handle:"D5DuLP"}],"7eSDFh":[function(t,e){function n(t,e,n){if(r.call(t,e))return t[e];var o=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:o,writable:!0,enumerable:!1}),o}catch(i){}return t[e]=o,o}var r=Object.prototype.hasOwnProperty;e.exports=n},{}],gos:[function(t,e){e.exports=t("7eSDFh")},{}],handle:[function(t,e){e.exports=t("D5DuLP")},{}],D5DuLP:[function(t,e){function n(t,e,n){return r.listeners(t).length?r.emit(t,e,n):(o[t]||(o[t]=[]),void o[t].push(e))}var r=t("ee").create(),o={};e.exports=n,n.ee=r,r.q=o},{ee:"QJf3ax"}],id:[function(t,e){e.exports=t("XL7HBI")},{}],XL7HBI:[function(t,e){function n(t){var e=typeof t;return!t||"object"!==e&&"function"!==e?-1:t===window?0:i(t,o,function(){return r++})}var r=1,o="nr@id",i=t("gos");e.exports=n},{gos:"7eSDFh"}],G9z0Bl:[function(t,e){function n(){var t=p.info=NREUM.info,e=u.getElementsByTagName("script")[0];if(t&&t.licenseKey&&t.applicationID&&e){s(d,function(e,n){e in t||(t[e]=n)});var n="https"===f.split(":")[0]||t.sslForHttp;p.proto=n?"https://":"http://",a("mark",["onload",i()]);var r=u.createElement("script");r.src=p.proto+t.agent,e.parentNode.insertBefore(r,e)}}function r(){"complete"===u.readyState&&o()}function o(){a("mark",["domContent",i()])}function i(){return(new Date).getTime()}var a=t("handle"),s=t(1),c=(t(2),window),u=c.document,f=(""+location).split("?")[0],d={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-632.min.js"},p=e.exports={offset:i(),origin:f,features:{}};u.addEventListener?(u.addEventListener("DOMContentLoaded",o,!1),c.addEventListener("load",n,!1)):(u.attachEvent("onreadystatechange",r),c.attachEvent("onload",n)),a("mark",["firstbyte",i()])},{1:20,2:11,handle:"D5DuLP"}],loader:[function(t,e){e.exports=t("G9z0Bl")},{}],20:[function(t,e){function n(t,e){var n=[],o="",i=0;for(o in t)r.call(t,o)&&(n[i]=e(o,t[o]),i+=1);return n}var r=Object.prototype.hasOwnProperty;e.exports=n},{}],21:[function(t,e){function n(t,e,n){e||(e=0),"undefined"==typeof n&&(n=t?t.length:0);for(var r=-1,o=n-e||0,i=Array(0>o?0:o);++r<o;)i[r]=t[e+r];return i}e.exports=n},{}],22:[function(t,e){function n(t){return!(t&&"function"==typeof t&&t.apply&&!t[i])}var r=t("ee"),o=t(1),i="nr@wrapper",a=Object.prototype.hasOwnProperty;e.exports=function(t){function e(t,e,r,a){function nrWrapper(){var n,i,s,u;try{i=this,n=o(arguments),s=r&&r(n,i)||{}}catch(d){f([d,"",[n,i,a],s])}c(e+"start",[n,i,a],s);try{return u=t.apply(i,n)}catch(p){throw c(e+"err",[n,i,p],s),p}finally{c(e+"end",[n,i,u],s)}}return n(t)?t:(e||(e=""),nrWrapper[i]=!0,u(t,nrWrapper),nrWrapper)}function s(t,r,o,i){o||(o="");var a,s,c,u="-"===o.charAt(0);for(c=0;c<r.length;c++)s=r[c],a=t[s],n(a)||(t[s]=e(a,u?s+o:o,i,s))}function c(e,n,r){try{t.emit(e,n,r)}catch(o){f([o,e,n,r])}}function u(t,e){if(Object.defineProperty&&Object.keys)try{var n=Object.keys(t);return n.forEach(function(n){Object.defineProperty(e,n,{get:function(){return t[n]},set:function(e){return t[n]=e,e}})}),e}catch(r){f([r])}for(var o in t)a.call(t,o)&&(e[o]=t[o]);return e}function f(e){try{t.emit("internal-error",e)}catch(n){}}return t||(t=r),e.inPlace=s,e.flag=i,e}},{1:21,ee:"QJf3ax"}]},{},["G9z0Bl",4,9]);</script>
  <meta name="viewport" content="width=device-width, initial-scale=1.0,user-scalable=no">
  <meta http-equiv="Cache-Control" content="no-siteapp" />
    <meta name="description"  content=" 本文希望达到的目标: 
 
 学习Queue模块 
 将Queue模块与多线程编程相结合 
 通过Queue和threading模块, 重构爬虫, 实现多线程爬虫,  
 通过以上学习希望总结出一个通用的多线程爬虫小模版 
Queue模块 
 
  Queue 模块实现了多生产者多消费者队列...">
    <script src="http://static.jianshu.io/assets/bugsnag-2.min-fe70f276e8f568dde506e088f89c2de2.js" data-apikey="5abb12613f217476dc531df54ad96676"></script>
  <meta property="wb:webmaster" content="294ec9de89e7fadb" />
  <meta property="qc:admins" content="104102651453316562112116375" />
  <meta property="qc:admins" content="11635613706305617" />
  <meta property="qc:admins" content="1163561616621163056375" />
  <meta name="google-site-verification" content="cV4-qkUJZR6gmFeajx_UyPe47GW9vY6cnCrYtCHYNh4" />
  <meta name="google-site-verification" content="HF7lfF8YEGs1qtCE-kPml8Z469e2RHhGajy6JPVy5XI" />
  <meta http-equiv="mobile-agent" content="format=html5; url=http://www.jianshu.com/p/544d406e0875">
    <!--  Meta for Twitter Card -->
  <meta content="summary" property="twitter:card">
  <meta content="@jianshucom" property="twitter:site">
  <meta content="Python爬虫(五)--多线程续(Queue)" property="twitter:title">
  <meta content=" 本文希望达到的目标: 
 
 学习Queue模块 
 将Queue模块与多线程编程相结合 
 通过Queue和threading模块, 重构爬虫, 实现多线程爬虫,  
 通过以上学习希望总结出一个通用的多线程爬虫小模版 
Queue模块 
 
  Queue 模块实现了多生产者多消费者队列..." property="twitter:description">
  <meta content="http://www.jianshu.com/p/544d406e0875" property="twitter:url">

  <!--  Meta for OpenGraph -->
  <meta content="Python爬虫(五)--多线程续(Queue)" property="og:title">
  <meta content=" 本文希望达到的目标: 
 
 学习Queue模块 
 将Queue模块与多线程编程相结合 
 通过Queue和threading模块, 重构爬虫, 实现多线程爬虫,  
 通过以上学习希望总结..." property="og:description">
  <meta content="简书" property="og:site_name">
  <meta content="website" property="og:type">
  <meta content="http://www.jianshu.com/p/544d406e0875" property="og:url">

  <title>Python爬虫(五)--多线程续(Queue) - 简书</title>
  <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="ZhqC3x2PrVhiywo3LeXwj49XyDRzpDzLDhaw5j4kwcFgUeesijq5k5NyzGbq1uhMZwl5MQ88bgwEqd4GZiYLBQ==" />
  <!--[if lte IE 8]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
  <link rel="stylesheet" media="all" href="http://static.jianshu.io/assets/base-c156372889a47bfbee99f363fb27d71c.css" />

    <link rel="stylesheet" media="all" href="http://static.jianshu.io/assets/reading-note-e329185fbae44a0663be84830810203f.css" />
  <link rel="stylesheet" media="all" href="http://static.jianshu.io/assets/base-read-mode-a9bad7207d2016fff3da6ab09f45c00e.css" />
  <script src="http://static.jianshu.io/assets/modernizr-e7102b17cba7a64f5c4c0cd94c770c58.js"></script>
  <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
  <!--[if IE 8]><link rel="stylesheet" media="all" href="http://static.jianshu.io/assets/scaffolding/for_ie-6b8b30d116ab19207e374dba85a67cb3.css" /><![endif]-->
  <!--[if lt IE 9]><link rel="stylesheet" media="all" href="http://static.jianshu.io/assets/scaffolding/for_ie-6b8b30d116ab19207e374dba85a67cb3.css" /><![endif]-->
  <link href="http://baijii-common.b0.upaiyun.com/icons/favicon.ico" rel="icon">
  <link rel="apple-touch-icon-precomposed" href="http://static.jianshu.io/assets/icon114-476190b41f5315e1029cf13e5c3a6093.png" />
  
  
  <script>
    var _czc = _czc || [];
    _czc.push(["_setAccount", "1253183112"]);
  </script>
</head>

  <body class="post output zh cn win ie lt-ie8 reader-day-mode reader-font2" data-js-module="note-show" data-locale="zh-CN">
    
    <div class="navbar navbar-jianshu shrink">
  <div class="dropdown">
    <a class="dropdown-toggle logo" id="dLabel" role="button" data-toggle="dropdown" data-target="#" href="javascript:void(0)">
      简
    </a>
    <ul class="dropdown-menu" role="menu" aria-labelledby="dLabel">
      <li><a href="/"><i class="fa fa-home"></i> 首页</a></li>
      <li><a href="/collections"><i class="fa fa-th"></i> 专题</a></li>
      <li><a href="/user_invitations"><i class="fa fa-money"></i> 发钱啦</a></li>
    </ul>
  </div>
</div>
<div class="navbar-user">
    <a class="login" data-signup-link="true" data-toggle="modal" href="/sign_up">
      <i class="fa fa-user"></i> 注册
</a>    <a class="login" data-signin-link="true" data-toggle="modal" href="/sign_in">
      <i class="fa fa-sign-in"></i> 登录
</a>    <a class="daytime set-view-mode pull-right" href="javascript:void(0)"><i class="fa fa-moon-o"></i></a>
</div>
<div class="navbar navbar-jianshu expanded">
  <div class="dropdown">
      <a class="active logo" role="button" data-original-title="个人主页" data-container="div.expanded" href="/">
        <b>简</b><i class="fa fa-home"></i><span class="title">首页</span>
</a>      <a data-toggle="tooltip" data-placement="right" data-original-title="专题" data-container="div.expanded" href="/collections">
        <i class="fa fa-th"></i><span class="title">专题</span>
</a>    <a data-toggle="tooltip" data-placement="right" data-original-title="下载手机应用" data-container="body" href="/apps">
      <i class="fa fa-mobile"></i><span class="title">下载手机应用</span>
</a>  </div>
  <div class="nav-user">
      <a href='#view-mode-modal' data-toggle='modal'><i class="fa fa-font"></i><span class="title">显示模式</span></a>

      <a class="signin" data-signin-link="true" data-toggle="modal" data-placement="right" data-original-title="登录" data-container="div.expanded" href="/sign_in">
        <i class="fa fa-sign-in"></i><span class="title">登录</span>
</a>    </div>
  </div>

    <div tabindex="-1" aria-hidden="true" id='login-modal' class="modal hide fade login-modal" data-js-module="login-modal">
  <div class="modal-header">
    <h4 class="title">
      <span>
        <a class="active" id="signin-link" href="javascript:void(null);">登录</a>
        <b>·</b>
        <a id="signup-link" href="javascript:void(null);">注册</a>
      </span>
    </h4>
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
  </div>

  <div class="modal-body large-login">
    <div class="sign-up">
      <form id="sign_up" class="form-horizontal" action="/users.json" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />
        <p id="signup_errors" class="signin_error hide"></p>
<div class="input-prepend">
  <span class="add-on"><i class="fa fa-envelope-o"></i></span>
  <input type="text" name="email" id="sign_up_email" value="" class="span2" placeholder="你的邮件地址" />
</div>
<div class="input-prepend">
  <span class="add-on"><i class="fa fa-user"></i></span>
  <input type="text" name="nickname" id="nickname" value="" class="span2" placeholder="选一个昵称" />
</div>
<div class="input-prepend">
  <span class="add-on"><i class="fa fa-unlock-alt"></i></span>
  <input type="password" name="password" id="sign_up_password" class="span2" placeholder="输入密码" />
</div>
<div class="input-prepend captcha">
  <div class="captcha_fields">
    
  </div>
</div>

<button name="button" type="submit" class="ladda-button submit-button" data-color="green" data-disable-with="<span class='ladda-label'>loading</span>"><span class='ladda-label'>注册</span></button>

</form>    </div>
    <div class="sign-in">
      <form id="sign_in" class="form-horizontal" action="/sessions.json" accept-charset="UTF-8" data-remote="true" method="post"><input name="utf8" type="hidden" value="&#x2713;" />
        <p id="signin_errors" class="signin_error hide"></p>
<div class="input-prepend">
  <span class="add-on"><i class="fa fa-envelope-o"></i></span>
  <input type="text" name="email" id="sign_in_email" value="" class="span2" placeholder="邮箱" />
</div>
<div class="input-prepend">
  <span class="add-on"><i class="fa fa-unlock-alt"></i></span>
  <input type="password" name="password" id="sign_in_password" class="span2" placeholder="密码" />
</div>
<div class="input-prepend captcha">
  <div class="captcha_fields">
    
  </div>
</div>

<button class="ladda-button submit-button" data-color="blue">
  <span class="ladda-label">登 录</span>
</button>
<div class="control-group text-left">
  <input type="checkbox" name="remember_me" id="remember_me" value="true" checked="checked" /> 记住我
  <a href="/users/password/new">忘记密码</a>
</div>

</form>    </div>

    <div class="login-sns">
      <p>您还可以通过以下方式直接登录</p>
      <ul class="login-sns">
        <li class="weibo">
          <a href="/users/auth/weibo"><i class="fa fa-weibo"></i></a>
        </li>
        <li class="qq">
          <a href="/users/auth/qq_connect"><i class="fa fa-qq"></i></a>
        </li>
        <li class="douban">
          <a href="/users/auth/douban"><i class="fa fa-douban"></i></a>
        </li>
        <li class="google">
          <a href="/users/auth/google_oauth2"><i class="fa fa-google-plus"></i></a>
        </li>
      </ul>
    </div>
  </div>
</div>

      <div class="fixed-btn">
    <a class="go-top hide-go-top" href="#"> <i class="fa fa-angle-up"></i></a>
    <a class="qrcode" data-target="#bottom-qrcode" data-toggle="modal" href="javascript:void(0)"><i class="fa fa-qrcode"></i></a>
    <a class="writer" href="/writer#/" data-toggle="tooltip" data-placement="left" title="写篇文章"><i class="fa fa-pencil"></i></a>
    <!-- qrcode modal -->
    <div id="bottom-qrcode" class="modal panel-modal hide fade" tabindex="-1" role="dialog" aria-hidden="true">
      <h4>下载简书移动应用</h4>
      <div class="panel-body"><img alt="Download app qrcode" src="http://static.jianshu.io/assets/app-page/download-app-qrcode-54b80569dd46614b3507ca15811edd62.png" /></div>
    </div>
  </div>


    <div id="show-note-container">
      

<div class="post-bg" id="flag">
  <div class="wrap-btn">
    <!-- Notebook and collections button upper left -->
      <div class="article-related pull-left">
          <a class="collection-menu-btn" data-toggle="modal" data-target="#collection-menu" href="javascript:void(null);">
            <i class="fa fa-th"></i>
</a>          <a class="notebooks-menu-btn" data-toggle="modal" data-target="#notebooks-menu" href="javascript:void(null);"><i class="fa fa-list-ul"></i></a>
        <div class="related-avatar-group activities"></div>
      </div>
    <!-- ******* -->

      <a class="login" data-signup-link="true" data-toggle="modal" href="/sign_up">
    <i class="fa fa-user"></i> 注册
</a>  <a class="login" data-signin-link="true" data-toggle="modal" href="/sign_in">
    <i class="fa fa-sign-in"></i> 登录
</a>

    <!-- Buttons upper right -->
    <!-- ******* -->
  </div>

  <div class="container">
    <!-- Article activities for width under 768px -->
    <div class="related-avatar-group activities"></div>
      <div class="article">
        <div class="preview">
          <h1 class="title">Python爬虫(五)--多线程续(Queue)</h1>
          <div class="meta-top">
            <a href="/users/4ee453b72aff">
              <div class="avatar" style="display:inline-block;"><img thumbnail="90x90" quality="100" src="http://upload.jianshu.io/users/upload_avatars/57011/820d1eedd165.jpg?imageMogr/thumbnail/90x90/quality/100" alt="820d1eedd165" /></div>
              <span>Andrew_liu</span>
</a>              <span data-toggle='tooltip' data-original-title='最后编辑于 2014.12.19 22:43'>2014.12.19 22:37*</span>
            <span class="wordage"></span>
            <span class="views-count"></span>
          </div>

          <!-- Collection/Bookmark/Share for width under 768px -->
          <div class="article-share"></div>
          <!-- -->

          <div class="show-content"><p>本文希望达到的目标:</p>
<ol>
<li>学习Queue模块</li>
<li>将Queue模块与多线程编程相结合</li>
<li>通过Queue和threading模块, 重构爬虫, 实现多线程爬虫, </li>
<li>通过以上学习希望总结出一个通用的多线程爬虫小模版</li>
</ol>
<h1>1. Queue模块</h1>
<hr>
<p><code>Queue</code>模块实现了多生产者多消费者队列, 尤其适合多线程编程.<code>Queue</code>类中<code>实现了所有需要的锁原语</code>(这句话非常重要), Queue模块实现了三种类型队列:</p>
<ul>
<li>FIFO(先进先出)队列, 第一加入队列的任务, 被第一个取出</li>
<li>LIFO(后进先出)队列,最后加入队列的任务, 被第一个取出(操作类似与栈, 总是从栈顶取出, 这个队列还不清楚内部的实现)</li>
<li>PriorityQueue(优先级)队列, 保持队列数据有序, 最小值被先取出(在C++中我记得优先级队列是可以自己重写排序规则的, Python不知道可以吗)</li>
</ul>
<h2>1.1. 类和异常</h2>
<pre><code>import Queue

#类
Queue.Queue(maxsize = 0)  #构造一个FIFO队列,maxsize设置队列大小的上界, 如果插入数据时, 达到上界会发生阻塞, 直到队列可以放入数据. 当maxsize小于或者等于0, 表示不限制队列的大小(默认)

Queue.LifoQueue(maxsize = 0)  #构造一LIFO队列,maxsize设置队列大小的上界, 如果插入数据时, 达到上界会发生阻塞, 直到队列可以放入数据. 当maxsize小于或者等于0, 表示不限制队列的大小(默认)

Queue.PriorityQueue(maxsize = 0)  #构造一个优先级队列,,maxsize设置队列大小的上界, 如果插入数据时, 达到上界会发生阻塞, 直到队列可以放入数据. 当maxsize小于或者等于0, 表示不限制队列的大小(默认). 优先级队列中, 最小值被最先取出

#异常
Queue.Empty  #当调用非阻塞的get()获取空队列的元素时, 引发异常
Queue.Full  #当调用非阻塞的put()向满队列中添加元素时, 引发异常</code></pre>
<h2>1.2. Queue对象</h2>
<p>三种队列对象<code>提供公共的方法</code></p>
<pre><code>Queue.empty()  #如果队列为空, 返回True(注意队列为空时, 并不能保证调用put()不会阻塞); 队列不空返回False(不空时, 不能保证调用get()不会阻塞)
Queue.full()  #如果队列为满, 返回True(不能保证调用get()不会阻塞), 如果队列不满, 返回False(并不能保证调用put()不会阻塞)

Queue.put(item[, block[, timeout]])  #向队列中放入元素, 如果可选参数block为True并且timeout参数为None(默认), 为阻塞型put(). 如果timeout是正数, 会阻塞timeout时间并引发Queue.Full异常. 如果block为False为非阻塞put
Queue.put_nowait(item)  #等价于put(itme, False)

Queue.get([block[, timeout]])  #移除列队元素并将元素返回, block = True为阻塞函数, block = False为非阻塞函数. 可能返回Queue.Empty异常
Queue.get_nowait()  #等价于get(False)

Queue.task_done()  #在完成一项工作之后，Queue.task_done()函数向任务已经完成的队列发送一个信号
Queue.join()  #实际上意味着等到队列为空，再执行别的操作</code></pre>
<p>下面是官方文档给多出的多线程模型:</p>
<pre><code>def worker():
    while True:
        item = q.get()
        do_work(item)
        q.task_done()

q = Queue()
for i in range(num_worker_threads):
     t = Thread(target=worker)
     t.daemon = True
     t.start()

for item in source():
    q.put(item)

q.join()       # block until all tasks are done</code></pre>
<h1>2. Queue模块与线程相结合</h1>
<hr>
<p>简单写了一个Queue和线程结合的小程序</p>
<pre><code>#!/usr/bin/env python
# -*- coding:utf-8 -*-

import threading
import time
import Queue

SHARE_Q = Queue.Queue()  #构造一个不限制大小的的队列
_WORKER_THREAD_NUM = 3   #设置线程个数

class MyThread(threading.Thread) :

    def __init__(self, func) :
        super(MyThread, self).__init__()
        self.func = func

    def run(self) :
        self.func()

def worker() :
    global SHARE_Q
    while not SHARE_Q.empty():
        item = SHARE_Q.get() #获得任务
        print "Processing : ", item
        time.sleep(1)

def main() :
    global SHARE_Q
    threads = []
    for task in xrange(5) :  #向队列中放入任务
        SHARE_Q.put(task)
    for i in xrange(_WORKER_THREAD_NUM) :
        thread = MyThread(worker)
        thread.start()
        threads.append(thread)
    for thread in threads :
        thread.join()

if __name__ == '__main__':
    main()</code></pre>
<h1>3. 重构爬虫</h1>
<hr>
<p>主要针对之间写过的豆瓣爬虫进行重构:</p>
<ul>
<li><a href="http://andrewliu.tk/2014/12/05/Python%E7%BD%91%E7%BB%9C%E7%88%AC%E8%99%AB-%E4%BA%8C-%E8%B1%86%E7%93%A3%E6%8A%93%E7%AB%99%E5%B0%8F%E8%AE%A1/" target="_blank">Python网络爬虫(二)--豆瓣抓站小计</a></li>
</ul>
<h2>3.1. 豆瓣电影爬虫重构</h2>
<p>通过对Queue和线程模型进行改写, 可以写出下面的爬虫程序 :</p>
<pre><code>#!/usr/bin/env python
# -*- coding:utf-8 -*-
# 多线程爬取豆瓣Top250的电影名称

import urllib2, re, string
import threading, Queue, time
import sys

reload(sys)
sys.setdefaultencoding('utf8')
_DATA = []
FILE_LOCK = threading.Lock()
SHARE_Q = Queue.Queue()  #构造一个不限制大小的的队列
_WORKER_THREAD_NUM = 3  #设置线程的个数

class MyThread(threading.Thread) :

    def __init__(self, func) :
        super(MyThread, self).__init__()  #调用父类的构造函数
        self.func = func  #传入线程函数逻辑

    def run(self) :
        self.func()

def worker() :
    global SHARE_Q
    while not SHARE_Q.empty():
        url = SHARE_Q.get() #获得任务
        my_page = get_page(url)  #爬取整个网页的HTML代码
        find_title(my_page)  #获得当前页面的电影名
        time.sleep(1)
        SHARE_Q.task_done()</code></pre>
<p>完整代码请查看<a href="https://github.com/Andrew-liu/dou_ban_spider/blob/master/threading_douban.py" target="_blank">Github豆瓣多线程爬虫</a><br>完成这个程序后, 又出现了新的问题:</p>
<blockquote><p>无法保证数据的顺序性, 因为线程是并发的, 思考的方法是: 设置一个主线程进行管理, 然后他们的线程工作</p></blockquote>
<h1>4. 通用的多线程爬虫小模版</h1>
<hr>
<p>下面是根据上面的爬虫做了点小改动后形成的模板</p>
<pre><code>#!/usr/bin/env python
# -*- coding:utf-8 -*-

import threading
import time
import Queue

SHARE_Q = Queue.Queue()  #构造一个不限制大小的的队列
_WORKER_THREAD_NUM = 3  #设置线程的个数

class MyThread(threading.Thread) :
    """

    doc of class

    Attributess:
        func: 线程函数逻辑
    """
    def __init__(self, func) :
        super(MyThread, self).__init__()  #调用父类的构造函数
        self.func = func  #传入线程函数逻辑

    def run(self) :
        """
        重写基类的run方法

        """
        self.func()

def do_something(item) :
    """
    运行逻辑, 比如抓站
    """
    print item

def worker() :
    """
    主要用来写工作逻辑, 只要队列不空持续处理
    队列为空时, 检查队列, 由于Queue中已经包含了wait,
    notify和锁, 所以不需要在取任务或者放任务的时候加锁解锁
    """
    global SHARE_Q
    while True : 
        if not SHARE_Q.empty():
            item = SHARE_Q.get() #获得任务
            do_something(item)
            time.sleep(1)
            SHARE_Q.task_done()


def main() :
    global SHARE_Q
    threads = []
    #向队列中放入任务, 真正使用时, 应该设置为可持续的放入任务
    for task in xrange(5) :   
        SHARE_Q.put(task)
    #开启_WORKER_THREAD_NUM个线程
    for i in xrange(_WORKER_THREAD_NUM) :
        thread = MyThread(worker)
        thread.start()  #线程开始处理任务
        threads.append(thread)
    for thread in threads :
        thread.join()
    #等待所有任务完成
    SHARE_Q.join()

if __name__ == '__main__':
    main()</code></pre>
<blockquote><p>我感觉其实这个多线程挺凌乱的, 希望以后自己能重构</p></blockquote>
<h1>5. 思考更高效的爬虫方法</h1>
<hr>
<ul>
<li>使用<a href="https://twistedmatrix.com/trac/wiki/Documentation" target="_blank">twisted</a>进行异步IO抓取</li>
<li>使用<code>Scrapy</code>框架(Scrapy 使用了 Twisted 异步网络库来处理网络通讯)</li>
</ul>
<h1>6. 参考链接</h1>
<hr>
<p><a href="https://docs.python.org/2/library/queue.html" target="_blank">Queue官方文档</a><br><a href="http://krondo.com/blog/?page_id=1327" target="_blank">Twisted英文入门指南</a><br><a href="http://turtlerbender007.appspot.com/twisted/index.html" target="_blank">Twisted中文入门指南</a></p>
</div>
        </div>
      </div>

      <div class="visitor_edit">
        <!-- further readings -->
        <div id="further-readings" data-user-slug="" data-user-nickname="">
          <div id="further-reading-line" class="hide further-reading-line"></div>
          <ul id="further-readings-list" class="reading-list unstyled"></ul>
          <div id="further-reading-new" class="reading-edit">
              <a data-signin-link="true" data-toggle="modal" href="/sign_in">
                <i class="fa fa-plus-circle"></i> 推荐拓展阅读
</a>            <div id="further-reading-form"></div>
          </div>
        </div>
      </div>
      

      <!-- article share button -->
      <div class="meta-bottom clearfix">
        <div class="share-group">
          <a href="javascript:void((function(s,d,e,r,l,p,t,z,c){var%20f=&#39;http://v.t.sina.com.cn/share/share.php?appkey=1881139527&#39;,u=z||d.location,p=[&#39;&amp;url=&#39;,e(u),&#39;&amp;title=&#39;,e(t||d.title),&#39;&amp;source=&#39;,e(r),&#39;&amp;sourceUrl=&#39;,e(l),&#39;&amp;content=&#39;,c||&#39;gb2312&#39;,&#39;&amp;pic=&#39;,e(p||&#39;&#39;)].join(&#39;&#39;);function%20a(){if(!window.open([f,p].join(&#39;&#39;),&#39;mb&#39;,[&#39;toolbar=0,status=0,resizable=1,width=440,height=430,left=&#39;,(s.width-440)/2,&#39;,top=&#39;,(s.height-430)/2].join(&#39;&#39;)))u.href=[f,p].join(&#39;&#39;);};if(/Firefox/.test(navigator.userAgent))setTimeout(a,0);else%20a();})(screen,document,encodeURIComponent,&#39;&#39;,&#39;&#39;,&#39;http://cwb.assets.jianshu.io/notes/images/420012/weibo/image_a29d83e5b19e.jpg&#39;, &#39;推荐 @永不停息的恐龙哥 的文章《Python爬虫(五)--多线程续(Queue)》（ 分享自 @简书 ）&#39;,&#39;http://www.jianshu.com/p/544d406e0875&#39;,&#39;页面编码gb2312|utf-8默认gb2312&#39;));" data-name="weibo">
            <i class="fa fa-weibo"></i><span>分享到微博</span>
          </a>
            <a data-toggle="modal" href="#share-weixin-modal" data-name="weixin">
              <i class="fa fa-weixin"></i><span>分享到微信</span>
            </a>
          <a href="javascript:void(function(){var d=document,e=encodeURIComponent,s1=window.getSelection,s2=d.getSelection,s3=d.selection,s=s1?s1():s2?s2():s3?s3.createRange().text:&#39;&#39;,r=&#39;http://www.douban.com/recommend/?url=&#39;+e(&#39;http://www.jianshu.com/p/544d406e0875&#39;)+&#39;&amp;title=&#39;+e(&#39;Python爬虫(五)--多线程续(Queue)&#39;)+&#39;&amp;sel=&#39;+e(s)+&#39;&amp;v=1&#39;,x=function(){if(!window.open(r,&#39;douban&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r+&#39;&amp;r=1&#39;};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})()" class="share-douban" data-name="douban"><i class="fa fa-douban"></i></%></a>
          <div class="more">
            <a href="javascript:void(0)" data-toggle="dropdown"><i class="fa fa-ellipsis-h"></i></a>
            <ul class="dropdown-menu arrow-top">
                <li><a href="http://cwb.assets.jianshu.io/notes/images/420012/weibo/image_a29d83e5b19e.jpg" target="_blank" data-name="changweibo"><i class="fa fa-arrow-circle-o-down"></i> 下载长微博图片</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://share.v.t.qq.com/index.php?c=share&amp;a=index&amp;url=&#39;+e(&#39;http://www.jianshu.com/p/544d406e0875&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(五)--多线程续(Queue)》（ 分享自 @jianshuio ）&#39;),x=function(){if(!window.open(r,&#39;tweibo&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="tweibo"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/tweibo.png">分享到腾讯微博</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url=&#39;+e(&#39;http://www.jianshu.com/p/544d406e0875&#39;)+&#39;&amp;title=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(五)--多线程续(Queue)》&#39;),x=function(){if(!window.open(r,&#39;qzone&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="qzone"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/qzone.png">分享到QQ空间</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://twitter.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/544d406e0875&#39;)+&#39;&amp;text=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(五)--多线程续(Queue)》（ 分享自 @jianshucom ）&#39;)+&#39;&amp;related=&#39;+e(&#39;jianshucom&#39;),x=function(){if(!window.open(r,&#39;twitter&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="twitter"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/twitter.png">分享到Twitter</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://www.facebook.com/sharer.php?s=100&amp;p[url]=&#39;+e(&#39;http://www.jianshu.com/p/544d406e0875&#39;)+&#39;&amp;p[title]=&#39;+e(&#39;Python爬虫(五)--多线程续(Queue) - 简书社&#39;)+&#39;&amp;p[summary]=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(五)--多线程续(Queue)》&#39;),x=function(){if(!window.open(r,&#39;facebook&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="facebook"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/facebook.png">分享到Facebook</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;https://plus.google.com/share?url=&#39;+e(&#39;http://www.jianshu.com/p/544d406e0875&#39;),x=function(){if(!window.open(r,&#39;google_plus&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=450,height=330&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="google_plus"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/google_plus.png">分享到Google+</a></li>
                <li><a href="javascript:void(function(){var d=document,e=encodeURIComponent,r=&#39;http://widget.renren.com/dialog/share?resourceUrl=&#39;+e(&#39;http://www.jianshu.com/p/544d406e0875&#39;)+&#39;&amp;description=&#39;+e(&#39;推荐 Andrew_liu 的文章《Python爬虫(五)--多线程续(Queue)》&#39;)+&#39;&amp;title=&#39;+e(&#39;Python爬虫(五)--多线程续(Queue)&#39;),x=function(){if(!window.open(r,&#39;renren&#39;,&#39;toolbar=0,resizable=1,scrollbars=yes,status=1,width=600,height=600&#39;))location.href=r};if(/Firefox/.test(navigator.userAgent)){setTimeout(x,0)}else{x()}})();" data-name="renren"><img src="http://baijii-common.b0.upaiyun.com/social_icons/32x32/renren.png">分享到人人网</a></li>
            </ul>
          </div>
        </div>
      </div>

      <!--  Like Button -->
      <div class="like">
          <a id="like-note" class="btn like-button" data-signin-link="true" data-toggle="modal" href="/sign_in">
            <span class="like-content"><i class="fa fa-heart-o"></i>  个喜欢</span>
</a>      </div>

      <!-- Reward / Support Author -->

      <!-- Modals -->
      <div id="share-weixin-modal" class="modal hide fade share-weixin-modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-header">
      <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    </div>
    <div class="modal-content">
      <div class="modal-body">
        <h5>打开微信“扫一扫”，打开网页后点击屏幕右上角分享按钮</h5>
        <img src="http://upload.jianshu.io/notes/qrcodes/420012/qrcode/544d406e0875.png" alt="544d406e0875" />
      </div>
    </div>
  </div>
</div>

      
      <div id="notebooks-menu" class="panel notebooks-menu arrow-top modal hide fade"><img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" /></div>
      <div id="collection-menu" class="panel collection-menu arrow-top modal hide fade"><img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" /></div>


    <!-- Bottom Author Info -->
      <div class="author-info clearfix">
        <h4 class="title">作者</h4>
        <div class="pull-left basic-info">
          <a class="avatar" href="/users/4ee453b72aff"><img thumbnail="90x90" quality="100" src="http://upload.jianshu.io/users/upload_avatars/57011/820d1eedd165.jpg?imageMogr/thumbnail/90x90/quality/100" alt="820d1eedd165" /></a>
          <div class="info-r">
            <p><a href="/users/4ee453b72aff">Andrew_liu</a></p>
            <div class="btn-group" id="follow_mail_block_user_57011">
    <div class="btn btn-small btn-success follow">
    <a data-signin-link="true" data-toggle="modal" href="/sign_in"><i class="fa fa-plus"></i>  <span>添加关注</span></a>
  </div>

  
<a class="btn btn-small btn-list btn-success" data-toggle="dropdown" href="javascript:void(0)"><i class="fa fa-bars"></i></a>
<ul class="dropdown-menu arrow-top" role="menu" aria-labelledby="dLabel">
    <li><a data-signin-link="true" data-toggle="modal" href="/sign_in"><i class="fa fa-fw fa-envelope"></i> 写简信</a></li>
    <li class="divider"></li>
  <li><a data-signin-link="true" data-toggle="modal" href="/sign_in"><i class="fa fa-fw fa-lock"></i> 加入黑名单</a></li>
  
</ul>

</div>
            <div class="sns">
              <a href="http://andrewliu.tk/"><img src="http://static.jianshu.io/assets/social_icons/48/home-e4e8d1a6d16511924dcfcefad511c707.png" alt="Home" /></a><a href="http://weibo.com/u/2874182973"><img src="http://static.jianshu.io/assets/social_icons/48/weibo_verified-115a327fa634fd790bbbe74aa892f9b6.png" alt="Weibo verified" /></a>
            </div>
          </div>
        </div>

        <div class="pull-left user-stats">
          <a href="/users/4ee453b72aff">
            <b></b><span>文章</span>
</a>          <a class="follow-user" href="/users/4ee453b72aff/followers">
            <b></b><span>粉丝</span>
</a>          <a href="/users/4ee453b72aff/top_articles">
            <b></b><span>喜欢</span>
</a>        </div>
      </div>
    <!-- -->

    <!-- Likes Items -->
    <div id="like-list" class="like-list clearfix"></div>

    <!-- Comments -->
    <div id="comments" class="comment-list clearfix">
          <p class="signout-comment">
    <a class="btn btn-info" data-signin-link="true" data-toggle="modal" href="/sign_in">
      登录后发表评论
</a>  </p>

        <div id="comment-list">
          <img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" />
        </div>
    </div>
    <!-- -->
  </div>

  <script type='application/json' data-name='note'>
    {"id":420012,"abbr":" 本文希望达到的目标: \n \n 学习Queue模块 \n 将Queue模块与多线程编程相结合 \n 通过Queue和threading模块, 重构爬虫, 实现多线程爬虫,  \n 通过以上学习希望总结出一个通用的多线程爬虫小模版 \nQueue模块 \n \n  Queue 模块实现了多生产者多消费者队列...","slug":"544d406e0875","url":"http://www.jianshu.com/p/544d406e0875","image_url":"http://cwb.assets.jianshu.io/notes/images/420012/weibo/image_a29d83e5b19e.jpg","wordage":1781,"has_further_readings":false,"views_count":435,"likes_count":8,"rewards_total_count":0}
  </script>

  <script type='application/json' data-name='author'>
    {"id":57011,"nickname":"Andrew_liu","slug":"4ee453b72aff","public_notes_count":33,"followers_count":273,"total_likes_count":736,"is_current_user":false}
  </script>


      <div class="author-article">
        <div class="content">
          <h5>作者的其他热门文章：</h5>
          <ul class="article-list clearfix">
              <li>
                <div class="article">
                  <a class="title" href="/p/fcf5199cfd2b?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_author_hots&amp;utm_source=recommendation">MatLab入门手册</a>
                  <div class="article-info">
                      收获了 101 个喜欢, 6 条评论
                  </div>
                </div>
              </li>
              <li>
                <div class="article">
                  <a class="title" href="/p/1a97412b27b0?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_author_hots&amp;utm_source=recommendation">Github资源整理</a>
                  <div class="article-info">
                      收获了 91 个喜欢, 3 条评论
                  </div>
                </div>
              </li>
              <li>
                <div class="article">
                  <a class="title" href="/p/194b0cf97c19?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_author_hots&amp;utm_source=recommendation">推荐那些功能强大的在线工具</a>
                  <div class="article-info">
                      收获了 64 个喜欢, 11 条评论
                  </div>
                </div>
              </li>
          </ul>
        </div>
      </div>

    <div class="other-article">
      <div class="content">
        <h5>你可能会感兴趣：</h5>
        <ul class="article-list clearfix">
            <li>
              <div class="article">
                <a class="title" href="/p/8347d4e5c543?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_all_hots&amp;utm_source=recommendation">暗恋就是向爱情投降</a>
                <div class="article-info">
                  <a class="author" href="/users/eaa02f8c63c3">安乔Lily</a>
                    收获了 586 个喜欢, 64 条评论
                </div>
              </div>
            </li>
            <li>
              <div class="article">
                <a class="title" href="/p/2c22f9bc810a?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_all_hots&amp;utm_source=recommendation">你愿苦其自身，必将掌声雷动。</a>
                <div class="article-info">
                  <a class="author" href="/users/7fe31ad480ec">颜夕遥</a>
                    收获了 1587 个喜欢, 135 条评论
                </div>
              </div>
            </li>
            <li>
              <div class="article">
                <a class="title" href="/p/4d25da730d32?utm_campaign=maleskine&amp;utm_content=note&amp;utm_medium=pc_all_hots&amp;utm_source=recommendation">只愿你们在一起</a>
                <div class="article-info">
                  <a class="author" href="/users/15ded056a7a5">烟波人长安</a>
                    收获了 660 个喜欢, 122 条评论
                </div>
              </div>
            </li>
        </ul>
      </div>
    </div>

  <!-- Modal -->

  
  
  <div id="notebooks-menu" class="panel notebooks-menu arrow-top modal hide fade"><img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" /></div>
  <div id="collection-menu" class="panel collection-menu arrow-top modal hide fade"><img class="loader-tiny" src="http://baijii-common.b0.upaiyun.com/loaders/tiny.gif" alt="Tiny" /></div>

</div>

    </div>
    
  <div id="view-mode-modal" tabindex="-1" class="modal hide read-modal" aria-hidden="false" data-js-module='view-mode-modal'>
    <div class="btn-group change-background" data-toggle="buttons-radio">
      <a class="btn btn-daytime active" data-mode="day" href="javascript:void(null);">
        <i class="fa fa-sun-o"></i>
</a>      <a class="btn btn-nighttime " data-mode="night" href="javascript:void(null);">
        <i class="fa fa-moon-o"></i>
</a>    </div>
    <div class="btn-group change-font" data-toggle="buttons-radio">
      <a class="btn font " data-font="font1" href="javascript:void(null);">宋体</a>
      <a class="btn font hei active" data-font="font2" href="javascript:void(null);">黑体</a>
    </div>
    <div class="btn-group change-locale" data-toggle="buttons-radio">
      <a class="btn font active" data-locale="zh-CN" href="javascript:void(null);">简</a>
      <a class="btn font hei " data-locale="zh-TW" href="javascript:void(null);">繁</a>
    </div>
  </div>


    <script src="http://static.jianshu.io/assets/base-4d9f7951538104176a7ce659d0e92d1e.js"></script>
    
    <script src="http://static.jianshu.io/assets/reading-base-9bf46f49d48d87bb0510f2005f32f0b9.js"></script>
    <script src="http://static.jianshu.io/assets/reading/module_sets/note_show-b18424df18fd387dff87565508974618.js"></script>
    <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-35169517-1']);
  _gaq.push(['_setCustomVar', 2, 'User Type', 'Visitor', 1 ]);
  _gaq.push(['_trackPageview']);

  

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>

<div style="display:none">
<script src="http://s95.cnzz.com/z_stat.php?id=1253183112&web_id=1253183112" language="JavaScript"></script>
</div>
  </body>
</html>
